!function(i,t){"function"==typeof define&&define.amd?define(["exports","riot"],function(e,n){t(i.i18n=e,n)}):"object"==typeof exports?t(exports,require("riot")):t(i.i18n={},i.riot)}(this,function(i,t){function e(){this._openCharacter="{",this._closeCharacter="}",this._entities={},this._default=n,this._language=this._default;var i=t.observable();this.on=i.on,this.off=i.off,this.trigger=i.trigger,this.on("lang",this.setLanguage)}var n="en";e.prototype.dictionary=function(i){this._entities=i},e.prototype.defaultLanguage=function(i){this._default=i},e.prototype.localise=function(i,t){function e(i,t,n,a){a=a||"",t=t||{},n=n||0;var s=i&&!i.length,o=s?Object.keys(i).length:0;if(s&&o>0){var r;for(r in i)a.split(".").length>n&&(a=a.split(".").splice(0,n).join(".")),a=0==n?r:a+"."+r,t=e(i[r],t,n+1,a)}else t[a]=i;return t}var n,a;if(this._entities[this._language]||(n=i),n||(n=(a=e(this._entities[this._language]))[i]?a[i]:i),t){var s,o=e(t);for(s in o)n=n.replace(new RegExp(this._openCharacter+s+this._closeCharacter,"g"),o[s])}return n},e.prototype.setSpecialCharacters=function(i,t){i&&(this._openCharacter=i),t&&(this._closeCharacter=t),this.trigger("update")},e.prototype.setLanguage=function(i){this._language=i||this._default,this.trigger("update")},e.prototype.getLanguage=function(){return this._language};var a,s=new e;for(a in s)i[a]=s[a];t.mixin("i18n",{i18n:i}),t.tag2("i1-8n",'<span ref="localised" name="localised"></span> <span ref="original" name="original" class="original"><yield></yield></span>','i1-8n,[data-is="i1-8n"]{ display: inline-block; } i1-8n .original,[data-is="i1-8n"] .original{ display: none; }',"",function(i){this.mixin("i18n"),this.i18n.on("update",function(){this.update()}.bind(this)),this.on("mount",function(){this.hasRefs=void 0!=this.refs,this.localise()}),this.on("update",function(){this.localise()}),this.localise=function(){var i=this.hasRefs?this.refs:this;i.localised.innerHTML=this.i18n.localise(i.original.innerHTML)}})});
