!function(i,t){"function"==typeof define&&define.amd?define(["exports","riot"],function(e,n){t(i.i18n=e,n)}):"object"==typeof exports?t(exports,require("riot")):t(i.i18n={},i.riot)}(this,function(i,t){var e="en";function n(){this._entities={},this._default=e,this._language=this._default;var i=t.observable();this.on=i.on,this.off=i.off,this.trigger=i.trigger,this.on("lang",this.setLanguage)}n.prototype.dictionary=function(i){this._entities=i},n.prototype.defaultLanguage=function(i){this._default=i},n.prototype.localize=function(i,t){var e,n;function o(i,t,e,n){n=n||"",t=t||{},e=e||0;var s,a=i&&!i.length,r=a?Object.keys(i).length:0;if(a&&r>0)for(s in i)n.split(".").length>e&&(n=n.split(".").splice(0,e).join(".")),n=0==e?s:n+"."+s,t=o(i[s],t,e+1,n);else t[n]=i;return t}if(this._entities[this._language]||(e=i),e||(e=(n=o(this._entities[this._language]))[i]?n[i]:i),t){var s,a=o(t);for(s in a)e=e.replace(new RegExp("{"+s+"}","g"),a[s])}return e},n.prototype.setLanguage=function(i){this._language=i||this._default,this.trigger("update")},n.prototype.getLanguage=function(){return this._language};var o,s=new n;for(o in s)i[o]=s[o];t.mixin("i18n",{i18n:i}),t.tag2("i1-8n",'<span ref="original"><yield></yield></span>','i1-8n,[riot-tag="i1-8n"],[data-is="i1-8n"]{ display: inline; }',"",function(i){this.mixin("i18n"),this.i18n.on("update",function(){this.update()}.bind(this)),this.on("mount",function(){this.hasRefs=void 0!=this.refs,this.localize()}),this.on("update",function(){this.localize()}),this.localize=function(){var i=this.hasRefs?this.refs:this,t=this.i18n.localize(i.original.innerHTML);for(var e in this.opts)t=t.replace("{"+e.replace(/([A-Z])/g,"-$1").toLowerCase()+"}",this.opts[e]);for(var n=this.root;n.hasChildNodes();)n.removeChild(n.firstChild);var o=document.createElement("span");o.innerHTML=t,n.appendChild(o)}})});
