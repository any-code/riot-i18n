!function(i,t){"function"==typeof define&&define.amd?define(["exports","riot"],function(n,e){t(i.i18n=n,e)}):"object"==typeof exports?t(exports,require("riot")):t(i.i18n={},i.riot)}(this,function(i,t){var n="en";function e(){this._entities={},this._default=n,this._language=this._default;var i=t.observable();this.on=i.on,this.off=i.off,this.trigger=i.trigger,this.on("lang",this.setLanguage)}e.prototype.dictionary=function(i){this._entities=i},e.prototype.defaultLanguage=function(i){this._default=i},e.prototype.localize=function(i,t){var n,e;function o(i,t,n,e){e=e||"",t=t||{},n=n||0;var a,s=i&&!i.length,r=s?Object.keys(i).length:0;if(s&&r>0)for(a in i)e.split(".").length>n&&(e=e.split(".").splice(0,n).join(".")),e=0==n?a:e+"."+a,t=o(i[a],t,n+1,e);else t[e]=i;return t}if(this._entities[this._language]||(n=i),n||(n=(e=o(this._entities[this._language]))[i]?e[i]:i),t){var a,s=o(t);for(a in s)n=n.replace(new RegExp("{"+a+"}","g"),s[a])}return n},e.prototype.setLanguage=function(i){this._language=i||this._default,this.trigger("update")},e.prototype.getLanguage=function(){return this._language};var o,a=new e;for(o in a)i[o]=a[o];t.mixin("i18n",{i18n:i}),t.tag2("i1-8n",'<span ref="localized"></span><span ref="original"><yield></yield></span>','i1-8n,[riot-tag="i1-8n"],[data-is="i1-8n"]{ display: inline; } i1-8n [ref="original"],[riot-tag="i1-8n"] [ref="original"],[data-is="i1-8n"] [ref="original"] { display: none; }',"",function(i){this.mixin("i18n"),this.i18n.on("update",function(){this.update()}.bind(this)),this.on("mount",function(){this.hasRefs=void 0!=this.refs,this.localize()}),this.on("update",function(){this.localize()}),this.localize=function(){var i=this.hasRefs?this.refs:this,t=this.i18n.localize(i.original.innerHTML);for(var n in this.opts)t=t.replace("{"+n.replace(/([A-Z])/g,"-$1").toLowerCase()+"}",this.opts[n]);i.localized.innerHTML=t}})});
